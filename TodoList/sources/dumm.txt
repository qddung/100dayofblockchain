/*
/// Module: todolist
module todolist::todolist;
*/

// For Move coding conventions, see
// https://docs.sui.io/concepts/sui-move-concepts/conventions

module todolist::todolist;

use std::string::{Self, String};
use std::vector;
use sui::object::{Self, UID};
use sui::tx_context::{Self, TxContext};

// package , owner, account, object(Type: Coin, Data type)

public enum ToDoStatus has copy, drop, store {
    New,
    Pending,
    Completed,
}

public struct ToDoItem has key, store {
    id: UID,
    description: String,
    completed: ToDoStatus,
}

public struct ToDoList has key, store {
    id: UID,
    items: vector<ToDoItem>,
}

fun init(ctx: &mut TxContext) {
    let ojbect = ToDoList {
        id: object::new(ctx),
        items: vector::empty<ToDoItem>(),
    };
    let _list_id = object::new(ctx);
    transfer::public_transfer(ojbect, tx_context::sender(ctx));
}

public fun createTodo(description: String, status: ToDoStatus): ToDoItem {
    let item = ToDoItem {
        id: object::new(ctx),
        description: description,
        completed: status,
    };
    item
}

/**
-- chưc năng
- Tạo mới
- Đổi tên
- Hoàn thành
- Xóa Task
- Sắp xếp ưu tiên
- làm walrus có upload thêm hình ảnh đi kèm

*/

public fun create_new(todo_list: ToDoList) {
    let newTodo: ToDoItem = createTodo(string::utf8(b"New Task"), ToDoStatus::New);
    todo_list.items.push_back(newTodo); 
}

public fun complete_task(item: &mut ToDoItem) {
    item.completed = ToDoStatus::Completed;
}

public fun delete_task(item: ToDoItem) {
    let ToDoItem { id, description, completed } = item;
    id.delete();
}
